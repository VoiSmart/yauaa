config:

- matcher:
    extract:
    - 'LayoutEngineClass     :   12:"Browser"'
    - 'LayoutEngineName      :   12:"AppleWebKit"'
    - 'LayoutEngineVersion   :   12:agent.product.(1)name="AppleWebKit"^.version'

- matcher:
    extract:
    - 'AgentClass            :   13:"Browser"'
    - 'AgentName             :   13:"AppleWebKit"'
    - 'AgentVersion          :   13:agent.product.(1)name="AppleWebKit"^.version'

- matcher:
    extract:
    - 'AgentClass            :   14:"Browser"'
    - 'AgentName             :   14:agent.product.(1)name="AppleWebKit"^>.name!="Mobile"'
    - 'AgentVersion          :   14:agent.product.(1)name="AppleWebKit"^>.version'

- matcher:
    require:
    - 'agent.(1)product.(1)name="Mozilla"'
    - 'agent.(1)product.(1)version="5.0"'
    extract:
    - 'AgentClass             :  10:"Browser"'
    - 'AgentName              :  10:agent.(1)product.(1)comments.entry.(1)product.(1)name'
    - 'AgentVersion           :  10:agent.(1)product.(1)comments.entry.(1)product.(1)version'

- matcher:
    require:
    - 'agent.(1)product.(1)name="Mozilla"'
    - 'agent.(1)product.(1)version="5.0"'
    - 'IsNull[agent.(2)product.(1)name="AppleWebKit"]'
    - 'IsNull[agent.(2)product.(1)name="Mobile"]'
    - 'IsNull[agent.(2)product.(1)name="Version"]'
    extract:
    - 'AgentClass             :  37:"Browser"'
    - 'AgentName              :  37:agent.(2)product.(1)name'
    - 'AgentVersion           :  37:agent.(2)product.(1)version'

- matcher:
    require:
    - 'agent.(1)product.(1)name="Mozilla"'
    - 'agent.(1)product.(1)version="5.0"'
    - 'IsNull[agent.(3)product.(1)name="AppleWebKit"]'
    - 'IsNull[agent.(3)product.(1)name="Mobile"]'
    - 'IsNull[agent.(3)product.(1)name="Version"]'
    extract:
    - 'AgentClass             :  36:"Browser"'
    - 'AgentName              :  36:agent.(3)product.(1)name'
    - 'AgentVersion           :  36:agent.(3)product.(1)version'

- matcher:
    require:
    - 'agent.(1)product.(1)name="Mozilla"'
    - 'agent.(1)product.(1)version="5.0"'
    - 'IsNull[agent.(4)product.(1)name="AppleWebKit"]'
    - 'IsNull[agent.(4)product.(1)name="Mobile"]'
    - 'IsNull[agent.(4)product.(1)name="Version"]'
    extract:
    - 'AgentClass             :  35:"Browser"'
    - 'AgentName              :  35:agent.(4)product.(1)name'
    - 'AgentVersion           :  35:agent.(4)product.(1)version'

- matcher:
    require:
    - 'agent.product.(1)name="AppleWebKit"'
    extract:
    - 'AgentClass            :   20:"Browser"'
    - 'AgentName             :   20:"Safari"'
    - 'AgentVersion          :   18:agent.product.(1)name="Safari"^.version'

- matcher:
    extract:
    - 'AgentClass            :   20:"Browser"'
    - 'AgentName             :   20:"Mobile Safari"'
    - 'AgentVersion          :   18:agent.product.(1)name="Mobile Safari"^.version'

- matcher:
    require:
    - 'agent.product.(1)name="Mobile Safari"'
    extract:
    - 'AgentClass            :   55:"Browser"'
    - 'AgentName             :   55:"Mobile Safari"'
    - 'AgentVersion          :   55:agent.product.(1)name="Version"^.version'

- matcher:
    require:
    - 'agent.product.(1)name="Safari"'
    extract:
    - 'AgentClass            :   55:"Browser"'
    - 'AgentName             :   55:"Safari"'
    - 'AgentVersion          :   55:agent.product.(1)name="Version"^.version'

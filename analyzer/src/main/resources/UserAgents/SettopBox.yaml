config:

- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry.(1)product.(1)name="AFTB Build"'
    extract:
    - 'DeviceClass           :   1001:"Set-top box"'
    - 'DeviceBrand           :   1001:"Amazon"'
    - 'DeviceName            :   1001:"Amazon Fire TV"'

- matcher:
    require:
    - 'agent.product.(1)name="AmazonWebAppPlatform"'
    extract:
    - 'DeviceClass           :   1001:"Set-top box"'
    - 'DeviceBrand           :   1001:"Amazon"'
    - 'DeviceName            :   1001:"Amazon Fire TV"'
    - 'WebviewAppName        :     12:"Amazon Web App Platform"'
    - 'WebviewAppVersion     :     12:agent.product.(1)name="cordova-amazon-fireos"^.version'

- matcher:
    extract:
    - 'DeviceClass           :   1001:"Set-top box"'
    - 'DeviceBrand           :   1001:"Google"'
    - 'DeviceName            :   1001:"Chromecast"'
    - 'DeviceVersion         :   1001:agent.(1)product.(1)comments.entry.(1)product.(1)name[-1]="CrKey"^.(1)version'

- matcher:
    extract:
    - 'DeviceClass           :   1002:"Set-top box"'
    - 'DeviceBrand           :   1002:"Google"'
    - 'DeviceName            :   1002:"Chromecast"'
    - 'DeviceVersion         :   1002:agent.(1)product.(1)comments.entry.(1)product.(1)name[-1]="CrKey"^.(2)version'

- matcher:
    extract:
    - 'DeviceClass           :   1003:"Set-top box"'
    - 'DeviceBrand           :   1003:"Google"'
    - 'DeviceName            :   1003:"Chromecast"'
    - 'DeviceVersion         :   1003:agent.product.(1)name="CrKey"^.version'

- matcher:
    extract:
    - 'DeviceClass           :   100:"Set-top box"'
    - 'OperatingSystemClass  :   100:"Embedded"'
    - 'OperatingSystemName   :   100:agent.(1)product.(1)comments.entry.(1)product.(1)name="GoogleTV"'
    - 'OperatingSystemVersion:   100:agent.(1)product.(1)comments.entry.(1)product.(1)name="GoogleTV"^.version'

- matcher:
    extract:
    - 'DeviceClass                         :  1100:"Set-top box"'
    - 'DeviceBrand                         :    10:"Google"'
    - 'DeviceName                          :    10:"Google TV"'
    - 'OperatingSystemClass                :   100:"Embedded"'
    - 'OperatingSystemName                 :   100:"GoogleTV"'
    - 'OperatingSystemVersion              :   100:"??"'
    - 'OperatingSystemVersionBuild         :   100:agent.product.(1)name="GoogleTV"^.version'

- matcher:
    extract:
    - 'DeviceClass           :  1101:"Set-top box"'
    - 'DeviceName            :     9:"Unknown Set-top box"'
    - 'AgentClass            :   101:"Browser"'
    - 'AgentName             :   101:agent.product.name="Large Screen Safari"^>.name'
    - 'AgentVersion          :   101:agent.product.name="Large Screen Safari"^>.version'

- matcher:
    extract:
    - 'DeviceBrand           :   10:LookUp[MobileBrands;agent.product.name="Large Screen Safari"^>.name[1]]'


- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry.product.(1)name{"NSX-"'
    extract:
    - 'OperatingSystemClass  : 1400:"Embedded"'
    - 'DeviceClass           : 1400:"Set-top box"'
    - 'DeviceName            :  400:agent.(1)product.(1)comments.entry.product.(1)name{"NSZ-"@'
    - 'DeviceBrand           :  400:"Sony"'


- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry.product.(1)name{"NSZ-"'
    extract:
    - 'OperatingSystemClass  : 1400:"Embedded"'
    - 'DeviceClass           : 1400:"Set-top box"'
    - 'DeviceName            :  400:agent.(1)product.(1)comments.entry.product.(1)name{"NSZ-"@'
    - 'DeviceBrand           :  400:"Sony"'

- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry.product.(1)name{"GTV"'
    extract:
    - 'OperatingSystemClass  : 1400:"Embedded"'
    - 'DeviceClass           : 1400:"Set-top box"'
    - 'DeviceName            :  400:"NeoTV"'
    - 'DeviceBrand           :  400:"Netgear"'

- matcher:
    extract:
    - 'OperatingSystemClass  :  1100:"Embedded"'
    - 'DeviceClass           :  1100:"Set-top box"'
    - 'DeviceName            :   400:"Smart TV box"'
    - 'DeviceBrand           :   400:agent.(1)product.(1)comments.entry.product.(1)name[2-4]="Smart TV box"@[1]'

- matcher:
    extract:
    - 'OperatingSystemClass  :  1100:"Embedded"'
    - 'DeviceClass           :  1100:"Set-top box"'
    - 'DeviceName            :  1100:agent.(1)product.(1)comments.entry.product.(1)name[2-3]="Android TV"@[1-3]'
    - 'DeviceBrand           :   300:agent.(1)product.(1)comments.entry.product.(1)name[2-3]="Android TV"@[1]'

- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry.product.(1)name[2]="TV"'
    extract:
    - 'OperatingSystemClass  :  1100:"Embedded"'
    - 'DeviceClass           :  1100:"Set-top box"'
    - 'DeviceName            :  1100:"Smart TV"'

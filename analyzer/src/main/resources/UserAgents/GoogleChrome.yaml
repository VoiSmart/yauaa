config:

- matcher:
    extract:
    - 'AgentClass            :   2014:"Browser"'
    - 'AgentName             :   2014:"Chrome"'
    - 'AgentVersion          :   2014:agent.product.(1)name="Chrome"^.version'

- matcher:
    extract:
    - 'AgentClass            :   2014:"Browser"'
    - 'AgentName             :   2014:"Chrome"'
    - 'AgentVersion          :   2014:agent.product.(1)name="CriOS"^.version'

- matcher:
    require:
    - 'LookUp[ChromeLayoutEngineName;agent.product.(1)name="Chrome"^.version[-1]]'
    extract:
    - 'LayoutEngineClass     :   1000:"Browser"'
    - 'LayoutEngineName      :   1000:"AppleWebKit"'
    - 'LayoutEngineVersion   :   1000:agent.product.(1)name="AppleWebKit"^.version'

- matcher:
    extract:
    - 'LayoutEngineClass     :    999:"Browser"'
    - 'LayoutEngineName      :    999:"Blink"'
    - 'LayoutEngineVersion   :    999:agent.product.(1)name="Chrome"^.version[-2]'

- matcher:
    require:
    - 'LookUp[ChromeLayoutEngineName;agent.product.(1)name="CriOS"^.version[-1]]'
    extract:
    - 'LayoutEngineClass     :   1000:"Browser"'
    - 'LayoutEngineName      :   1000:"AppleWebKit"'
    - 'LayoutEngineVersion   :   1000:agent.product.(1)name="AppleWebKit"^.version'

- matcher:
    extract:
    - 'LayoutEngineClass     :    999:"Browser"'
    - 'LayoutEngineName      :    999:"Blink"'
    - 'LayoutEngineVersion   :    999:agent.product.(1)name="CriOS"^.version[-2]'

- matcher:
    require:
    - 'LookUp[ChromeLayoutEngineName;agent.product.(1)name="Mobile Chrome"^.version[-1]]'
    extract:
    - 'DeviceClass           :   1000:"Phone"'
    - 'LayoutEngineClass     :   1000:"Browser"'
    - 'LayoutEngineName      :   1000:"AppleWebKit"'
    - 'LayoutEngineVersion   :   1000:agent.product.(1)name="AppleWebKit"^.version'

- matcher:
    extract:
    - 'DeviceClass           :    999:"Phone"'
    - 'LayoutEngineClass     :    999:"Browser"'
    - 'LayoutEngineName      :    999:"Blink"'
    - 'LayoutEngineVersion   :    999:agent.product.(1)name="Mobile Chrome"^.version[-2]'


- lookup:
    name: 'ChromeLayoutEngineName'
    map:
      "0"  : "AppleWebKit"
      "1"  : "AppleWebKit"
      "2"  : "AppleWebKit"
      "3"  : "AppleWebKit"
      "4"  : "AppleWebKit"
      "5"  : "AppleWebKit"
      "6"  : "AppleWebKit"
      "7"  : "AppleWebKit"
      "8"  : "AppleWebKit"
      "9"  : "AppleWebKit"
      "10" : "AppleWebKit"
      "11" : "AppleWebKit"
      "12" : "AppleWebKit"
      "13" : "AppleWebKit"
      "14" : "AppleWebKit"
      "15" : "AppleWebKit"
      "16" : "AppleWebKit"
      "17" : "AppleWebKit"
      "18" : "AppleWebKit"
      "19" : "AppleWebKit"
      "20" : "AppleWebKit"
      "21" : "AppleWebKit"
      "22" : "AppleWebKit"
      "23" : "AppleWebKit"
      "24" : "AppleWebKit"
      "25" : "AppleWebKit"
      "26" : "AppleWebKit"
      "27" : "AppleWebKit"

- matcher:
    require:
    - 'agent.product.(1)name="Version"'
    extract:
    - 'AgentClass        :   2500:"Browser Webview"'
    - 'AgentName         :   2500:"Chrome Webview"'
    - 'AgentVersion      :   2500:agent.product.(1)name="Chrome"^.version'
    - 'WebviewAppName    :      0:"Unknown Webview App"'
    - 'WebviewAppVersion :      0:"??"'

- matcher:
    require:
    - 'agent.product.(1)name="Version"'
    extract:
    - 'AgentClass        :   2500:"Browser Webview"'
    - 'AgentName         :   2500:"Chrome Webview"'
    - 'AgentVersion      :   2500:agent.product.(1)name="Chrome"^.version'
    - 'WebviewAppName    :     10:NormalizeBrand[agent.product.(1)name="Chrome"^>>.name]'
    - 'WebviewAppVersion :     10:agent.product.(1)name="Chrome"^>>.version'

- matcher:
    variable:
    - 'WebViewProduct: agent.product.(1)name="Chrome"^>>'
    require:
    - 'agent.product.(1)name="Version"'
    extract:
    - 'AgentClass        :   2500:"Browser Webview"'
    - 'AgentName         :   2500:"Chrome Webview"'
    - 'AgentVersion      :   2500:agent.product.(1)name="Chrome"^.version'
    - 'WebviewAppName    :     11:LookUp[SpecialChromeBrowserNames;@WebViewProduct.name]'
    - 'WebviewAppVersion :     11:@WebViewProduct.version'

- matcher:
    require:
    - 'agent.product.(1)name="Version"'
    - 'agent.product.(1)name="Chrome"'
    variable:
    - 'WebViewProduct: agent.product.(1)name="Version"^>>.name="Chrome"^<'
    extract:
    - 'AgentClass        :   2500:"Browser Webview"'
    - 'AgentName         :   2500:"Chrome Webview"'
    - 'AgentVersion      :   2500:agent.product.(1)name="Chrome"^.version'
    - 'WebviewAppName    :     12:LookUp[SpecialChromeBrowserNames;@WebViewProduct.name]'
    - 'WebviewAppVersion :     12:@WebViewProduct.version'


- matcher:
    require:
    - 'agent.product.(1)name="Version"'
    - 'agent.product.(1)name="Chrome"'
    - 'agent.product.(1)name="Safari"'
    variable:
    - 'WebViewProduct: agent.product.(1)name="Version"^>.name="Chrome"^>>.name="Safari"^<'
    extract:
    - 'AgentClass        :   2500:"Browser Webview"'
    - 'AgentName         :   2500:"Chrome Webview"'
    - 'AgentVersion      :   2500:agent.product.(1)name="Chrome"^.version'
    - 'WebviewAppName    :     12:LookUp[SpecialChromeBrowserNames;@WebViewProduct.name]'
    - 'WebviewAppVersion :     12:@WebViewProduct.version'

- matcher:
    require:
    - 'agent.product.(1)name="Version"'
    - 'agent.product.(1)name="Chrome"'
    - 'agent.product.(1)name="Mobile Safari"'
    variable:
    - 'WebViewProduct: agent.product.(1)name="Version"^>.name="Chrome"^>>.name="Mobile Safari"^<'
    extract:
    - 'AgentClass        :   2500:"Browser Webview"'
    - 'AgentName         :   2500:"Chrome Webview"'
    - 'AgentVersion      :   2500:agent.product.(1)name="Chrome"^.version'
    - 'WebviewAppName    :     12:LookUp[SpecialChromeBrowserNames;@WebViewProduct.name]'
    - 'WebviewAppVersion :     12:@WebViewProduct.version'

- lookup:
    name: 'KnownWebviewAppNames'
    map:
      'GSApp' : 'Google Search App'
      'Focus' : 'Firefox Focus'

- matcher:
    variable:
    - 'WebViewProduct: agent.product.(1)name="Chrome"^>>'
    require:
    - 'agent.product.(1)name="Version"'
    extract:
    - 'AgentClass        :   2500:"Browser Webview"'
    - 'AgentName         :   2500:"Chrome Webview"'
    - 'AgentVersion      :   2500:agent.product.(1)name="Chrome"^.version'
    - 'WebviewAppName    :     11:LookUp[KnownWebviewAppNames;@WebViewProduct.name]'
    - 'WebviewAppVersion :     11:@WebViewProduct.version'

- matcher:
    variable:
    - 'WebViewProduct: agent.product.(1)name="Version"^>>.name="Chrome"^<'
    extract:
    - 'AgentClass        :   2500:"Browser Webview"'
    - 'AgentName         :   2500:"Chrome Webview"'
    - 'AgentVersion      :   2500:agent.product.(1)name="Chrome"^.version'
    - 'WebviewAppName    :     12:LookUp[KnownWebviewAppNames;@WebViewProduct.name]'
    - 'WebviewAppVersion :     12:@WebViewProduct.version'

- matcher:
    variable:
    - 'WebViewProduct: agent.product.(1)name="Version"^>>.name="Chrome"^<'
    extract:
    - 'AgentClass        :   2500:"Browser Webview"'
    - 'AgentName         :   2500:"Chrome Webview"'
    - 'AgentVersion      :   2500:agent.product.(1)name="Chrome"^.version'
    - 'WebviewAppName    :     11:@WebViewProduct.name'
    - 'WebviewAppVersion :     11:@WebViewProduct.version'



- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry.(1)text="wv"'
    extract:
    - 'AgentClass      :   10000:"Browser Webview"'
    - 'AgentName       :   10000:"Chrome Webview"'
    - 'AgentVersion    :   10000:agent.product.(1)name="Chrome"^.version'
    - 'WebviewAppName    :    0:"Unknown Webview App"'
    - 'WebviewAppVersion :    0:"??"'

- lookup:
    name: 'SpecialChromeBrowserNames'
    map:
      "Vivaldi"         : "Vivaldi"
      "OPR"             : "Opera"
      "MMS"             : "Opera Neon"
      "OPT"             : "Opera Touch"
      "Amigo"           : "Amigo"       # https://amigo.mail.ru/
      "MRCHROME"        : "Amigo"       # https://amigo.mail.ru/
      "MRPULSE"         : "Pulse"       # https://amigo.mail.ru/
      "Chromium"        : "Chromium"
      "Ubuntu Chromium" : "Chromium"
      "Epiphany"        : "Epiphany"
      "UCBrowser"       : "UCBrowser"

- matcher:
    variable:
    - 'ProductAfterChrome: agent.product.(1)name="Chrome"^>'
    extract:
    - 'AgentName             :   2022:LookUp[SpecialChromeBrowserNames;@ProductAfterChrome.(1)name]'
    - 'AgentVersion          :   2022:@ProductAfterChrome.(1)version'

- matcher:
    variable:
    - 'ProductAfterChrome: agent.product.(1)name="Chrome"^>>'
    extract:
    - 'AgentName             :   2021:LookUp[SpecialChromeBrowserNames;@ProductAfterChrome.(1)name]'
    - 'AgentVersion          :   2021:@ProductAfterChrome.(1)version'

- matcher:
    variable:
    - 'ProductAfterChrome: agent.product.(1)name="Chrome"^>>>'
    extract:
    - 'AgentName             :   2020:LookUp[SpecialChromeBrowserNames;@ProductAfterChrome.(1)name]'
    - 'AgentVersion          :   2020:@ProductAfterChrome.(1)version'

- matcher:
    variable:
    - 'ProductAfterChrome: agent.product.(1)name="Chrome"^>>>>'
    extract:
    - 'AgentName             :   2019:LookUp[SpecialChromeBrowserNames;@ProductAfterChrome.(1)name]'
    - 'AgentVersion          :   2019:@ProductAfterChrome.(1)version'

- matcher:
    extract:
    - 'AgentName             :   2019:LookUp[SpecialChromeBrowserNames;agent.text]'
    - 'AgentVersion          :   2019:agent.product.(1)name="Chrome"^.version'

- matcher:
    variable:
    - 'ProductBeforeChrome: agent.product.(1)name="Chrome"^<'
    extract:
    - 'AgentName             :   2017:LookUp[SpecialChromeBrowserNames;@ProductBeforeChrome.(1)name]'
    - 'AgentVersion          :   2017:@ProductBeforeChrome.(1)version'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.99 Safari/537.36 Vivaldi/1.0.321.3'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'Windows 10.0'
      OperatingSystemNameVersion           : 'Windows 10.0'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '45.0'
      LayoutEngineVersionMajor             : '45'
      LayoutEngineNameVersion              : 'Blink 45.0'
      LayoutEngineNameVersionMajor         : 'Blink 45'
      AgentClass                           : 'Browser'
      AgentName                            : 'Vivaldi'
      AgentVersion                         : '1.0.321.3'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Vivaldi 1.0.321.3'
      AgentNameVersionMajor                : 'Vivaldi 1'

# Opera Neon
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.21 Safari/537.36 MMS/1.0.2459.0'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'Windows 7'
      OperatingSystemNameVersion           : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '53.0'
      LayoutEngineVersionMajor             : '53'
      LayoutEngineNameVersion              : 'Blink 53.0'
      LayoutEngineNameVersionMajor         : 'Blink 53'
      AgentClass                           : 'Browser'
      AgentName                            : 'Opera Neon'
      AgentVersion                         : '1.0.2459.0'
      AgentVersionMajor                    : '1'
      AgentNameVersion                     : 'Opera Neon 1.0.2459.0'
      AgentNameVersionMajor                : 'Opera Neon 1'

# TODO: Confusing case. I am unsure what the right value for the CPU and the bits of the CPU are.
#- test:
#    input:
#      user_agent_string: 'Mozilla/5.0 (X11; Linux i686 (x86_64)) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36'
#    expected:
#      DeviceCpu                            : 'Intel i686'
#      DeviceCpuBits                        : '32'
#      OperatingSystemName                  : 'Linux'
#      OperatingSystemVersion               : 'Intel i686'
#      OperatingSystemNameVersion           : 'Linux Intel i686'

- test:
    input:
      # Pulse browser from https://amigo.mail.ru/
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.0; Nexus 6 Build/NBD92G) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.105 Mobile Safari/537.36 MRPULSE v1.3.5'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Google Nexus 6'
      DeviceBrand                          : 'Google'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.0'
      OperatingSystemNameVersion           : 'Android 7.0'
      OperatingSystemVersionBuild          : 'NBD92G'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '55.0'
      LayoutEngineVersionMajor             : '55'
      LayoutEngineNameVersion              : 'Blink 55.0'
      LayoutEngineNameVersionMajor         : 'Blink 55'
      AgentClass                           : 'Browser'
      AgentName                            : 'Pulse'
      AgentVersion                         : 'v1.3.5'
      AgentVersionMajor                    : 'v1'
      AgentNameVersion                     : 'Pulse v1.3.5'
      AgentNameVersionMajor                : 'Pulse v1'

- test:
    input:
      # Several sources on the internet indicate this is a robot
      #   https://github.com/fnando/browser/issues/205
      #   http://www.spambotsecurity.com/forum/viewtopic.php?f=7&t=1424
      # It is also possible MrChrome is just the internal name name of the Amigo browser
      # (The android variant is called Pulse which shows MRPULSE)
      # See https://amigo.mail.ru/
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/32.0.1709.117 Amigo/32.0.1709.117 MRCHROME SOC Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'Windows Vista'
      OperatingSystemNameVersion           : 'Windows Vista'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '32.0'
      LayoutEngineVersionMajor             : '32'
      LayoutEngineNameVersion              : 'Blink 32.0'
      LayoutEngineNameVersionMajor         : 'Blink 32'
      AgentClass                           : 'Browser'
      AgentName                            : 'Amigo'
      AgentVersion                         : '32.0.1709.117'
      AgentVersionMajor                    : '32'
      AgentNameVersion                     : 'Amigo 32.0.1709.117'
      AgentNameVersionMajor                : 'Amigo 32'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.46 Safari/535.11 MRCHROME'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Windows NT'
      OperatingSystemVersion               : 'Windows 7'
      OperatingSystemNameVersion           : 'Windows 7'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '535.11'
      LayoutEngineVersionMajor             : '535'
      LayoutEngineNameVersion              : 'AppleWebKit 535.11'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 535'
      AgentClass                           : 'Browser'
      AgentName                            : 'Amigo'
      AgentVersion                         : '17.0.963.46'
      AgentVersionMajor                    : '17'
      AgentNameVersion                     : 'Amigo 17.0.963.46'
      AgentNameVersionMajor                : 'Amigo 17'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.1) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Focus/1.3 Chrome/60.0.3112.116 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '60.0'
      LayoutEngineVersionMajor             : '60'
      LayoutEngineNameVersion              : 'Blink 60.0'
      LayoutEngineNameVersionMajor         : 'Blink 60'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '60.0.3112.116'
      AgentVersionMajor                    : '60'
      AgentNameVersion                     : 'Chrome Webview 60.0.3112.116'
      AgentNameVersionMajor                : 'Chrome Webview 60'
      WebviewAppName                       : 'Firefox Focus'
      WebviewAppNameVersionMajor           : 'Firefox Focus 1'
      WebviewAppVersion                    : '1.3'
      WebviewAppVersionMajor               : '1'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.1) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 SomeThing Unexpected/3.14 Chrome/60.0.3112.116 Mobile Safari/537.36'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '60.0'
      LayoutEngineVersionMajor             : '60'
      LayoutEngineNameVersion              : 'Blink 60.0'
      LayoutEngineNameVersionMajor         : 'Blink 60'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '60.0.3112.116'
      AgentVersionMajor                    : '60'
      AgentNameVersion                     : 'Chrome Webview 60.0.3112.116'
      AgentNameVersionMajor                : 'Chrome Webview 60'
      WebviewAppName                       : 'SomeThing Unexpected'
      WebviewAppNameVersionMajor           : 'SomeThing Unexpected 3'
      WebviewAppVersion                    : '3.14'
      WebviewAppVersionMajor               : '3'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (Linux; Android 7.1.1) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/60.0.3112.116 Mobile Safari/537.36 SomeThing Unexpected/3.14'
    expected:
      DeviceClass                          : 'Phone'
      DeviceName                           : 'Android Mobile'
      DeviceBrand                          : 'Unknown'
      OperatingSystemClass                 : 'Mobile'
      OperatingSystemName                  : 'Android'
      OperatingSystemVersion               : '7.1.1'
      OperatingSystemNameVersion           : 'Android 7.1.1'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '60.0'
      LayoutEngineVersionMajor             : '60'
      LayoutEngineNameVersion              : 'Blink 60.0'
      LayoutEngineNameVersionMajor         : 'Blink 60'
      AgentClass                           : 'Browser Webview'
      AgentName                            : 'Chrome Webview'
      AgentVersion                         : '60.0.3112.116'
      AgentVersionMajor                    : '60'
      AgentNameVersion                     : 'Chrome Webview 60.0.3112.116'
      AgentNameVersionMajor                : 'Chrome Webview 60'
      WebviewAppName                       : 'SomeThing Unexpected'
      WebviewAppNameVersionMajor           : 'SomeThing Unexpected 3'
      WebviewAppVersion                    : '3.14'
      WebviewAppVersionMajor               : '3'

# Chromium
- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/45.0.2454.101 Chrome/45.0.2454.101 Safari/537.36 FirePHP/4Chrome'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '??'
      OperatingSystemNameVersion           : 'Ubuntu ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '45.0'
      LayoutEngineVersionMajor             : '45'
      LayoutEngineNameVersion              : 'Blink 45.0'
      LayoutEngineNameVersionMajor         : 'Blink 45'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chromium'
      AgentVersion                         : '45.0.2454.101'
      AgentVersionMajor                    : '45'
      AgentNameVersion                     : 'Chromium 45.0.2454.101'
      AgentNameVersionMajor                : 'Chromium 45'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/45.0.2454.101 Chrome/45.0.2454.101 Safari/537.36,gzip(gfe)'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '??'
      OperatingSystemNameVersion           : 'Ubuntu ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '45.0'
      LayoutEngineVersionMajor             : '45'
      LayoutEngineNameVersion              : 'Blink 45.0'
      LayoutEngineNameVersionMajor         : 'Blink 45'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chromium'
      AgentVersion                         : '45.0.2454.101'
      AgentVersionMajor                    : '45'
      AgentNameVersion                     : 'Chromium 45.0.2454.101'
      AgentNameVersionMajor                : 'Chromium 45'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/535.22+ (KHTML, like Gecko) Chromium/17.0.963.56 Chrome/17.0.963.56 Safari/535.22+ Debian/7.0 (3.4.2-2.1) Epiphany/3.4.2'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Debian'
      OperatingSystemVersion               : '7.0'
      OperatingSystemNameVersion           : 'Debian 7.0'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '535.22'
      LayoutEngineVersionMajor             : '535'
      LayoutEngineNameVersion              : 'AppleWebKit 535.22'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 535'
      AgentClass                           : 'Browser'
      AgentName                            : 'Epiphany'
      AgentVersion                         : '3.4.2'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Epiphany 3.4.2'
      AgentNameVersionMajor                : 'Epiphany 3'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (SMART-TV; X11; Linux armv7l) AppleWebKit/537.42 (KHTML, like Gecko) Chromium/25.0.1349.2 Chrome/25.0.1349.2 Safari/537.42'
    expected:
      DeviceClass                          : 'TV'
      DeviceName                           : 'Samsung Smart TV'
      DeviceBrand                          : 'Samsung'
      DeviceCpu                            : 'ARMv7l'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Embedded'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : 'SmartTV'
      OperatingSystemNameVersion           : 'Linux SmartTV'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.42'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.42'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chromium'
      AgentVersion                         : '25.0.1349.2'
      AgentVersionMajor                    : '25'
      AgentNameVersion                     : 'Chromium 25.0.1349.2'
      AgentNameVersionMajor                : 'Chromium 25'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (SMART-TV; X11; Linux armv7l) AppleWebkit/537.42 (KHTML, like Gecko) Chromium/25.0.1349.2 Chrome/25.0.1349.2 Safari/537.42,gzip(gfe)'
    expected:
      DeviceClass                          : 'TV'
      DeviceName                           : 'Samsung Smart TV'
      DeviceBrand                          : 'Samsung'
      DeviceCpu                            : 'ARMv7l'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Embedded'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : 'SmartTV'
      OperatingSystemNameVersion           : 'Linux SmartTV'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.42'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.42'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chromium'
      AgentVersion                         : '25.0.1349.2'
      AgentVersionMajor                    : '25'
      AgentNameVersion                     : 'Chromium 25.0.1349.2'
      AgentNameVersionMajor                : 'Chromium 25'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux armv7l) AppleWebKit/537.6+ (KHTML, like Gecko) Chromium/23.0.1271.95 Chrome/23.0.1271.95 Safari/537.6+ Epiphany/3.6.1'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'ARMv7l'
      DeviceCpuBits                        : '32'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Linux'
      OperatingSystemVersion               : 'ARMv7l'
      OperatingSystemNameVersion           : 'Linux ARMv7l'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'AppleWebKit'
      LayoutEngineVersion                  : '537.6'
      LayoutEngineVersionMajor             : '537'
      LayoutEngineNameVersion              : 'AppleWebKit 537.6'
      LayoutEngineNameVersionMajor         : 'AppleWebKit 537'
      AgentClass                           : 'Browser'
      AgentName                            : 'Epiphany'
      AgentVersion                         : '3.6.1'
      AgentVersionMajor                    : '3'
      AgentNameVersion                     : 'Epiphany 3.6.1'
      AgentNameVersionMajor                : 'Epiphany 3'

- test:
    input:
      user_agent_string: 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/62.0.3202.89 Chrome/62.0.3202.89 Safari/537.36'
    expected:
      DeviceClass                          : 'Desktop'
      DeviceName                           : 'Linux Desktop'
      DeviceBrand                          : 'Unknown'
      DeviceCpu                            : 'Intel x86_64'
      DeviceCpuBits                        : '64'
      OperatingSystemClass                 : 'Desktop'
      OperatingSystemName                  : 'Ubuntu'
      OperatingSystemVersion               : '??'
      OperatingSystemNameVersion           : 'Ubuntu ??'
      LayoutEngineClass                    : 'Browser'
      LayoutEngineName                     : 'Blink'
      LayoutEngineVersion                  : '62.0'
      LayoutEngineVersionMajor             : '62'
      LayoutEngineNameVersion              : 'Blink 62.0'
      LayoutEngineNameVersionMajor         : 'Blink 62'
      AgentClass                           : 'Browser'
      AgentName                            : 'Chromium'
      AgentVersion                         : '62.0.3202.89'
      AgentVersionMajor                    : '62'
      AgentNameVersion                     : 'Chromium 62.0.3202.89'
      AgentNameVersionMajor                : 'Chromium 62'


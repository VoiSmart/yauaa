config:

- matcher:
    extract:
    - 'AgentClass            :   2014:"Browser"'
    - 'AgentName             :   2014:"Chrome"'
    - 'AgentVersion          :   2014:agent.product.(1)name="Chrome"^.version'

- matcher:
    extract:
    - 'AgentClass            :   2014:"Browser"'
    - 'AgentName             :   2014:"Chrome"'
    - 'AgentVersion          :   2014:agent.product.(1)name="CriOS"^.version'

- matcher:
    require:
    - 'LookUp[ChromeLayoutEngineName;agent.product.(1)name="Chrome"^.version[-1]]'
    extract:
    - 'LayoutEngineClass     :   1000:"Browser"'
    - 'LayoutEngineName      :   1000:"AppleWebKit"'
    - 'LayoutEngineVersion   :   1000:agent.product.(1)name="AppleWebKit"^.version'

- matcher:
    extract:
    - 'LayoutEngineClass     :    999:"Browser"'
    - 'LayoutEngineName      :    999:"Blink"'
    - 'LayoutEngineVersion   :    999:agent.product.(1)name="Chrome"^.version[-2]'

- matcher:
    require:
    - 'LookUp[ChromeLayoutEngineName;agent.product.(1)name="CriOS"^.version[-1]]'
    extract:
    - 'LayoutEngineClass     :   1000:"Browser"'
    - 'LayoutEngineName      :   1000:"AppleWebKit"'
    - 'LayoutEngineVersion   :   1000:agent.product.(1)name="AppleWebKit"^.version'

- matcher:
    extract:
    - 'LayoutEngineClass     :    999:"Browser"'
    - 'LayoutEngineName      :    999:"Blink"'
    - 'LayoutEngineVersion   :    999:agent.product.(1)name="CriOS"^.version[-2]'

- matcher:
    require:
    - 'LookUp[ChromeLayoutEngineName;agent.product.(1)name="Mobile Chrome"^.version[-1]]'
    extract:
    - 'DeviceClass           :   1000:"Phone"'
    - 'LayoutEngineClass     :   1000:"Browser"'
    - 'LayoutEngineName      :   1000:"AppleWebKit"'
    - 'LayoutEngineVersion   :   1000:agent.product.(1)name="AppleWebKit"^.version'

- matcher:
    extract:
    - 'DeviceClass           :    999:"Phone"'
    - 'LayoutEngineClass     :    999:"Browser"'
    - 'LayoutEngineName      :    999:"Blink"'
    - 'LayoutEngineVersion   :    999:agent.product.(1)name="Mobile Chrome"^.version[-2]'


- lookup:
    name: 'ChromeLayoutEngineName'
    map:
      "0"  : "AppleWebKit"
      "1"  : "AppleWebKit"
      "2"  : "AppleWebKit"
      "3"  : "AppleWebKit"
      "4"  : "AppleWebKit"
      "5"  : "AppleWebKit"
      "6"  : "AppleWebKit"
      "7"  : "AppleWebKit"
      "8"  : "AppleWebKit"
      "9"  : "AppleWebKit"
      "10" : "AppleWebKit"
      "11" : "AppleWebKit"
      "12" : "AppleWebKit"
      "13" : "AppleWebKit"
      "14" : "AppleWebKit"
      "15" : "AppleWebKit"
      "16" : "AppleWebKit"
      "17" : "AppleWebKit"
      "18" : "AppleWebKit"
      "19" : "AppleWebKit"
      "20" : "AppleWebKit"
      "21" : "AppleWebKit"
      "22" : "AppleWebKit"
      "23" : "AppleWebKit"
      "24" : "AppleWebKit"
      "25" : "AppleWebKit"
      "26" : "AppleWebKit"
      "27" : "AppleWebKit"

- matcher:
    require:
    - 'agent.product.(1)name="Version"'
    extract:
    - 'AgentClass        :   2500:"Browser Webview"'
    - 'AgentName         :   2500:"Chrome Webview"'
    - 'AgentVersion      :   2500:agent.product.(1)name="Chrome"^.version'
    - 'WebviewAppName    :      0:"Unknown Webview App"'
    - 'WebviewAppVersion :      0:"??"'

- matcher:
    require:
    - 'agent.product.(1)name="Version"'
    extract:
    - 'AgentClass        :   2500:"Browser Webview"'
    - 'AgentName         :   2500:"Chrome Webview"'
    - 'AgentVersion      :   2500:agent.product.(1)name="Chrome"^.version'
    - 'WebviewAppName    :     10:NormalizeBrand[agent.product.(1)name="Chrome"^>>.name]'
    - 'WebviewAppVersion :     10:agent.product.(1)name="Chrome"^>>.version'

- matcher:
    variable:
    - 'WebViewProduct: agent.product.(1)name="Chrome"^>>'
    require:
    - 'agent.product.(1)name="Version"'
    extract:
    - 'AgentClass        :   2500:"Browser Webview"'
    - 'AgentName         :   2500:"Chrome Webview"'
    - 'AgentVersion      :   2500:agent.product.(1)name="Chrome"^.version'
    - 'WebviewAppName    :     11:LookUp[SpecialChromeBrowserNames;@WebViewProduct.name]'
    - 'WebviewAppVersion :     11:@WebViewProduct.version'

- matcher:
    require:
    - 'agent.product.(1)name="Version"'
    - 'agent.product.(1)name="Chrome"'
    variable:
    - 'WebViewProduct: agent.product.(1)name="Version"^>>.name="Chrome"^<'
    extract:
    - 'AgentClass        :   2500:"Browser Webview"'
    - 'AgentName         :   2500:"Chrome Webview"'
    - 'AgentVersion      :   2500:agent.product.(1)name="Chrome"^.version'
    - 'WebviewAppName    :     12:LookUp[SpecialChromeBrowserNames;@WebViewProduct.name]'
    - 'WebviewAppVersion :     12:@WebViewProduct.version'


- matcher:
    require:
    - 'agent.product.(1)name="Version"'
    - 'agent.product.(1)name="Chrome"'
    - 'agent.product.(1)name="Safari"'
    variable:
    - 'WebViewProduct: agent.product.(1)name="Version"^>.name="Chrome"^>>.name="Safari"^<'
    extract:
    - 'AgentClass        :   2500:"Browser Webview"'
    - 'AgentName         :   2500:"Chrome Webview"'
    - 'AgentVersion      :   2500:agent.product.(1)name="Chrome"^.version'
    - 'WebviewAppName    :     12:LookUp[SpecialChromeBrowserNames;@WebViewProduct.name]'
    - 'WebviewAppVersion :     12:@WebViewProduct.version'

- matcher:
    require:
    - 'agent.product.(1)name="Version"'
    - 'agent.product.(1)name="Chrome"'
    - 'agent.product.(1)name="Mobile Safari"'
    variable:
    - 'WebViewProduct: agent.product.(1)name="Version"^>.name="Chrome"^>>.name="Mobile Safari"^<'
    extract:
    - 'AgentClass        :   2500:"Browser Webview"'
    - 'AgentName         :   2500:"Chrome Webview"'
    - 'AgentVersion      :   2500:agent.product.(1)name="Chrome"^.version'
    - 'WebviewAppName    :     12:LookUp[SpecialChromeBrowserNames;@WebViewProduct.name]'
    - 'WebviewAppVersion :     12:@WebViewProduct.version'

- lookup:
    name: 'KnownWebviewAppNames'
    map:
      'GSApp' : 'Google Search App'
      'Focus' : 'Firefox Focus'

- matcher:
    variable:
    - 'WebViewProduct: agent.product.(1)name="Chrome"^>>'
    require:
    - 'agent.product.(1)name="Version"'
    extract:
    - 'AgentClass        :   2500:"Browser Webview"'
    - 'AgentName         :   2500:"Chrome Webview"'
    - 'AgentVersion      :   2500:agent.product.(1)name="Chrome"^.version'
    - 'WebviewAppName    :     11:LookUp[KnownWebviewAppNames;@WebViewProduct.name]'
    - 'WebviewAppVersion :     11:@WebViewProduct.version'

- matcher:
    variable:
    - 'WebViewProduct: agent.product.(1)name="Version"^>>.name="Chrome"^<'
    extract:
    - 'AgentClass        :   2500:"Browser Webview"'
    - 'AgentName         :   2500:"Chrome Webview"'
    - 'AgentVersion      :   2500:agent.product.(1)name="Chrome"^.version'
    - 'WebviewAppName    :     12:LookUp[KnownWebviewAppNames;@WebViewProduct.name]'
    - 'WebviewAppVersion :     12:@WebViewProduct.version'

- matcher:
    variable:
    - 'WebViewProduct: agent.product.(1)name="Version"^>>.name="Chrome"^<'
    extract:
    - 'AgentClass        :   2500:"Browser Webview"'
    - 'AgentName         :   2500:"Chrome Webview"'
    - 'AgentVersion      :   2500:agent.product.(1)name="Chrome"^.version'
    - 'WebviewAppName    :     11:@WebViewProduct.name'
    - 'WebviewAppVersion :     11:@WebViewProduct.version'



- matcher:
    require:
    - 'agent.(1)product.(1)comments.entry.(1)text="wv"'
    extract:
    - 'AgentClass      :   10000:"Browser Webview"'
    - 'AgentName       :   10000:"Chrome Webview"'
    - 'AgentVersion    :   10000:agent.product.(1)name="Chrome"^.version'
    - 'WebviewAppName    :    0:"Unknown Webview App"'
    - 'WebviewAppVersion :    0:"??"'

- lookup:
    name: 'SpecialChromeBrowserNames'
    map:
      "Vivaldi"         : "Vivaldi"
      "OPR"             : "Opera"
      "MMS"             : "Opera Neon"
      "Amigo"           : "Amigo"       # https://amigo.mail.ru/
      "MRCHROME"        : "Amigo"       # https://amigo.mail.ru/
      "MRPULSE"         : "Pulse"       # https://amigo.mail.ru/
      "Chromium"        : "Chromium"
      "Ubuntu Chromium" : "Chromium"
      "Epiphany"        : "Epiphany"
      "UCBrowser"       : "UCBrowser"

- matcher:
    variable:
    - 'ProductAfterChrome: agent.product.(1)name="Chrome"^>'
    extract:
    - 'AgentName             :   2022:LookUp[SpecialChromeBrowserNames;@ProductAfterChrome.(1)name]'
    - 'AgentVersion          :   2022:@ProductAfterChrome.(1)version'

- matcher:
    variable:
    - 'ProductAfterChrome: agent.product.(1)name="Chrome"^>>'
    extract:
    - 'AgentName             :   2021:LookUp[SpecialChromeBrowserNames;@ProductAfterChrome.(1)name]'
    - 'AgentVersion          :   2021:@ProductAfterChrome.(1)version'

- matcher:
    variable:
    - 'ProductAfterChrome: agent.product.(1)name="Chrome"^>>>'
    extract:
    - 'AgentName             :   2020:LookUp[SpecialChromeBrowserNames;@ProductAfterChrome.(1)name]'
    - 'AgentVersion          :   2020:@ProductAfterChrome.(1)version'

- matcher:
    variable:
    - 'ProductAfterChrome: agent.product.(1)name="Chrome"^>>>>'
    extract:
    - 'AgentName             :   2019:LookUp[SpecialChromeBrowserNames;@ProductAfterChrome.(1)name]'
    - 'AgentVersion          :   2019:@ProductAfterChrome.(1)version'

- matcher:
    extract:
    - 'AgentName             :   2019:LookUp[SpecialChromeBrowserNames;agent.text]'
    - 'AgentVersion          :   2019:agent.product.(1)name="Chrome"^.version'

- matcher:
    variable:
    - 'ProductBeforeChrome: agent.product.(1)name="Chrome"^<'
    extract:
    - 'AgentName             :   2017:LookUp[SpecialChromeBrowserNames;@ProductBeforeChrome.(1)name]'
    - 'AgentVersion          :   2017:@ProductBeforeChrome.(1)version'

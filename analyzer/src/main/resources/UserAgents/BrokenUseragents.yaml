config:

- matcher:
    variable:
    - 'BeforeBrowser: agent.(1)product.(1)comments.entry.product.(1)name="Browser"^<'
    require:
    - 'agent.(1)product.(1)comments.entry.product.(1)name="Browser"^.(1)version="Browser"'
    extract:
    - 'DeviceClass    :   50:"Mobile"'
    - 'DeviceBrand    : 1000:NormalizeBrand[@BeforeBrowser.name]'
    - 'DeviceName     : 1000:@BeforeBrowser.(1)version'
    - 'DeviceVersion  : 1000:@BeforeBrowser.(2)version'

- matcher:
    require:
    - 'agent.(1)product.(1)name[3]="Mozilla"'
    - 'agent.(1)product.(1)name[1]{"PB"'
    extract:
    - 'AgentClass     :3000:"Browser"'
    - 'AgentName      :3000:"PirateBrowser"'
    - 'AgentVersion   :3000:agent.(1)product.(1)name[-2]'

- matcher:
    extract:
    - 'AgentClass            :  100:"Browser"'
    - 'AgentName             :  100:"Silk"'
    - 'AgentVersion          :  100:agent.(1)product.(1)comments.entry.(1)product.(1)name="Silk"^.version'

- matcher:
    extract:
    - 'AgentClass            :  100:"Browser"'
    - 'AgentName             :  100:"SogouMobileBrowser"'
    - 'AgentVersion          :  100:agent.product.(1)name="SogouMSE,SogouMobileBrowser"^.version'

- matcher:
    extract:
    - 'AgentClass : 0:"Special"'
    - 'AgentName  : 1:agent.(1)text'





- matcher:
    extract:
    - 'AgentClass     :    100:"Browser"'
    - 'AgentName      :    100:"Abonti"'
    - 'AgentVersion   :    100:agent.(1)product.(1)comments.entry.(1)product.(1)name="Abonti"^.version'

- matcher:
    require:
    - 'agent.(1-2)product.(1)comments.entry.(1)product.(1)name="Android"'
    - 'agent.text="Mobile"'
    - 'IsNull[agent.text="Mobile"^>]'
    extract:
    - 'DeviceClass                 :   500:"Phone"'
    - 'OperatingSystemClass        :   500:"Mobile"'

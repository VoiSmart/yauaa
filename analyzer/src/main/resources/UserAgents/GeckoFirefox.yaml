config:

- matcher:
    extract:
    - 'LayoutEngineClass    :  2000:"Browser"'
    - 'LayoutEngineName     :  2000:"Gecko"'
    - 'LayoutEngineVersion  :  2000:agent.(1)product.comments.entry.keyvalue.key="rv"^.value'
    - 'LayoutEngineBuild    :  2000:agent.(2-5)product.name="Gecko"^.version'
    - 'AgentClass           :  1995:"Browser"'
    - 'AgentName            :  1995:"Gecko"'
    - 'AgentVersion         :  1995:agent.(1)product.comments.entry.keyvalue.key="rv"^.value'

- matcher:
    variable:
    - 'Gecko: agent.(2-5)product.name="Gecko"^>'
    extract:
    - 'AgentClass           :  2000:"Browser"'
    - 'AgentName            :  2000:@Gecko.name'
    - 'AgentVersion         :  2000:@Gecko.version'

- matcher:
    variable:
    - 'Gecko: agent.(2-5)product.name="Gecko"^>>'
    extract:
    - 'AgentClass           :  2001:"Browser"'
    - 'AgentName            :  2001:@Gecko.name[-1]!="anonymized"@'
    - 'AgentVersion         :  2001:@Gecko.version'

- matcher:
    variable:
    - 'Gecko: agent.(2-5)product.name="Gecko"^>'
    require:
    - 'agent.(3-6)product.name[2]="Firefox"' # Performance trick
    extract:
    - 'AgentClass           :  2002:"Browser"'
    - 'AgentName            :  2002:@Gecko.name[2]="Firefox"'
    - 'AgentVersion         :  2002:@Gecko.version'

- matcher:
    variable:
    - 'Gecko: agent.(2-5)product.name="Gecko"^>'
    require:
    - 'agent.(3-6)product.name[3]="Firefox"' # Performance trick
    extract:
    - 'AgentClass           :  2002:"Browser"'
    - 'AgentName            :  2002:@Gecko.name[3]="Firefox"'
    - 'AgentVersion         :  2002:@Gecko.version'

- matcher:
    variable:
    - 'Gecko: agent.(2-5)product.name="Gecko"^>>'
    require:
    - 'agent.(4-7)product.name[2]="Firefox"' # Performance trick
    extract:
    - 'AgentClass           :  2003:"Browser"'
    - 'AgentName            :  2003:@Gecko.name[2]="Firefox"'
    - 'AgentVersion         :  2003:@Gecko.version'

- matcher:
    variable:
    - 'Gecko: agent.(2-5)product.name="Gecko"^>>'
    require:
    - 'agent.(4-7)product.name[3]="Firefox"' # Performance trick
    extract:
    - 'AgentClass           :  2003:"Browser"'
    - 'AgentName            :  2003:@Gecko.name[3]="Firefox"'
    - 'AgentVersion         :  2003:@Gecko.version'

- matcher:
    extract:
    - 'LayoutEngineClass    :  1900:"Browser"'
    - 'LayoutEngineName     :  1900:"Gecko"'
    - 'LayoutEngineVersion  :  1900:agent.(1)product.comments.entry.keyvalue.key="rv"^.value'
    - 'LayoutEngineBuild    :  1900:agent.product.comments.entry.product.name="Gecko"^.version'
    - 'AgentClass           :  1895:"Browser"'
    - 'AgentName            :  1895:"Gecko"'
    - 'AgentVersion         :  1895:agent.(1)product.comments.entry.keyvalue.key="rv"^.value'

- matcher:
    variable:
    - 'Gecko: agent.product.comments.entry.product.name="Gecko"^>'
    extract:
    - 'AgentClass           :  1900:"Browser"'
    - 'AgentName            :  1900:@Gecko.name'
    - 'AgentVersion         :  1900:@Gecko.version'
